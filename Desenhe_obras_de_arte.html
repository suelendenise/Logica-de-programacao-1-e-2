<meta charset="utf-8">

<canvas width="600" height="400"></canvas>

<script>
	
	function desenhaQuadrdo(x, y, tamanho, cor) {

		pincel.fillStyle = cor;
		pincel.fillRect(x, y, tamanho, tamanho);
		pincel.fill();
	}

	function desenhaCirculo(x, y, raio, cor) {

		pincel.fillStyle = cor; // o padrão é blue
		pincel.beginPath();
		pincel.arc(x, y, raio, 0, 2 * 3.14);
		pincel.fill();

	}

	function desenhaPaletaDeCores() {
		desenhaQuadrdo(xVermelho, yQuadrado, tamanhoQuadrados, "red");
		desenhaQuadrdo(xVerde, yQuadrado, tamanhoQuadrados, "green");
		desenhaQuadrdo(xAzul, yQuadrado, tamanhoQuadrados, "blue");

	}

	function lidaComMovimentoDoMouse(evento) {

		var x = evento.pageX - tela.offsetLeft;
		var y = evento.pageY - tela.offsetTop;

		// usando a nova fução

		if(desenha && podeDesenharNaArea(x,y)) {
			desenhaCirculo(x,y, 5, corAtual);
		}
	}

	function habilitaDesenhar() {

		desenha = true;
	}

	function desabilitaDesnhar() {

		desenha = false;
	}

	function podeDesenharNaArea(x, y) {

		if(x >= 0 && x < 3*tamanhoQuadrados && y >= 0 && y < tamanhoQuadrados) {
			return false;
		} else {
			return true;
		}
	}

	function selecionaCor(evento) {

		var x = evento.pageX - tela.offsetLeft;
		var y = evento.pageY - tela.offsetTop;

		// agora que sei onde o usuário clicou, posso verificar em qual cor da paleta ele esta clicando!
	}

	var tela = document.querySelector("canvas");
	var pincel = tela.getContext("2d");
	pincel.fillStyle = "lightgray";
	pincel.fillRect(0, 0, 600, 400);

	var desenha = false;
	var corAtual = "blue";
	var xVermelho = 0;
	var xVerde = 50;
	var xAzul = 100;
	var yQuadrado = 0;
	var tamanhoQuadrados = 50;

	desenhaPaletaDeCores(); // desenha a paletaDeCores

	tela.onmousemove = lidaComMovimentoDoMouse;

	tela.onmouseup = habilitaDesenhar;

	// aqui! Estou associando a função selecionaCor ao evento onclick de tela!

	tela.onclick = selecionaCor;


</script>